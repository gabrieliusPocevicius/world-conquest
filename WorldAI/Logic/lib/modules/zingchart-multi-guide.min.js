/*
All of the code within the ZingChart software is developed and copyrighted by ZingChart, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from ZingChart. All usage must coincide with the
ZingChart End User License Agreement which can be requested by email at support@zingchart.com.

Build 2.9.1
*/
zingchart.setModule("multi-guide"),function(){function e(e){var i=zingchart.getLoader(e.id),t=zingchart.getModules(i);if(-1!==ZC.AV(t,"multi-guide")){var a=zingchart.exec(e.id,"getobjectsbyclass",{type:"shape","class":"multi-guide"});zingchart.exec(e.id,"removeobject",{type:"shape",id:a,update:!1});var d=zingchart.exec(e.id,"getobjectsbyclass",{type:"label","class":"multi-guide"});zingchart.exec(e.id,"removeobject",{type:"label",id:d,update:!0})}}var i,t=[],a=0,d=0,l=!1,o=0,n={},c={};zingchart.bind(null,"guide_mousemove",function(e){var i=zingchart.getLoader(e.id),c=zingchart.getModules(i);if(-1!==ZC.AV(c,"multi-guide")){var r=zingchart.getGraph(i,e.graphid).getData(),g={};r.options&&(g=r.options["multi-guide"]||r.options);var u=zingchart.exec(e.id,"getobjectinfo",{graphid:e.graphid,object:"plotarea"});if(t=[].concat(e.items),a=e.guide.x,l){n["guide_"+d]=[].concat(e.items);var h=(g.handle||{}).size||4;zingchart.exec(e.id,"updateobject",{data:[{objtype:"shape",type:"poly",id:"multi_guide_handle_"+o,points:[[a,u.y],[a-2*h,u.y-h],[a-2*h,u.y-3*h],[a+2*h,u.y-3*h],[a+2*h,u.y-h],[a,u.y]]},{objtype:"label",id:"multi_guide_label_"+o,x:a}]})}}}),zingchart.bind(null,"zoom",function(i){e(i)}),zingchart.bind(null,"legend_item_click",function(i){e(i)}),zingchart.bind(null,"label_mouseover",function(e){var i=zingchart.getLoader(e.id),t=zingchart.getModules(i);-1!==ZC.AV(t,"multi-guide")&&-1!==e.labelid.indexOf("multi_guide_label_")&&zingchart.exec(e.id,"hideguide")}),zingchart.bind(null,"label_mouseout",function(e){var i=zingchart.getLoader(e.id),t=zingchart.getModules(i);-1!==ZC.AV(t,"multi-guide")&&-1!==e.labelid.indexOf("multi_guide_label_")&&zingchart.exec(e.id,"showguide")}),zingchart.bind(null,"click",function(e){if(("none"===e.target||"node"===e.target)&&e.plotarea){var l=zingchart.getLoader(e.id),o=zingchart.getModules(l);if(-1!==ZC.AV(o,"multi-guide")){var r=zingchart.getGraph(l,e.graphid).getData(),g={};r.options&&(g=r.options["multi-guide"]||r.options);var u=zingchart.exec(e.id,"getobjectinfo",{graphid:e.graphid,object:"plotarea"});if(t.length>0){var h=d+1+"";n["guide_"+d]=[].concat(t),c["guide_"+d]=h;var _=g.label||{},p={align:"left",color:"#000","background-color":"#fff #ccc","border-width":1,"border-color":"#333",bold:!0,"font-size":10,padding:"4 8"};ZC._cp_(_,p),ZC._cp_({text:h},p),(i=zingchart.getInstance(l,"textbox")).setData(p),i.parse(),ZC._cp_({objtype:"label",id:"multi_guide_label_"+d,"class":"multi-guide",cursor:"hand",x:a,y:u.y+u.height-i.get("height")},p);var s=g.line||{},b={"line-width":1,"line-color":"#333"};ZC._cp_(s,b),ZC._cp_({objtype:"shape",type:"line",id:"multi_guide_line_"+d,flat:!0,"class":"multi-guide",points:[[a,u.y],[a,u.y+u.height]]},b);var m=g.handle||{},y={"background-color":"#fff #ccc","border-width":1,"border-color":"#333","z-index":1,cursor:"hand"};ZC._cp_(m,y);var x=m.size||4;ZC._cp_({objtype:"shape",type:"poly",id:"multi_guide_handle_"+d,"class":"multi-guide",points:[[a,u.y],[a-2*x,u.y-x],[a-2*x,u.y-3*x],[a+2*x,u.y-3*x],[a+2*x,u.y-x],[a,u.y]]},y);var f=g.close||{},z={"background-color":"#fff #ccc","hover-state":{"background-color":"#fff #fbb"},"border-width":1,color:"#000","border-color":"#333",padding:"0 4 2 4","font-size":10,"border-radius":3,anchor:"c",shadow:!0,"z-index":99};ZC._cp_(f,z);var v=f.text||"x";ZC._cp_({objtype:"label",id:"multi_guide_close_"+d,cursor:"hand","class":"multi-guide",x:a+2.5*x,y:u.y-3.5*x,text:v},z),zingchart.exec(e.id,"addobject",{data:[b,y,z,p],update:!1});for(var j=0;j<t.length;j++){var C=zingchart.exec(e.id,"getobjectinfo",{object:"node",plotindex:t[j].plotindex,nodeindex:t[j].nodeindex});zingchart.exec(e.id,"addobject",{type:"label",data:[{id:"multi_guide_label_"+d+"_"+j,"class":"multi-guide",x:t[j].x,y:t[j].y,text:t[j].text,color:C.color,"background-color":C.lineColor,padding:"3 6",callout:!0,"callout-position":a<u.x+u.width/2?"left":"right"}],update:!1})}zingchart.exec(e.id,"repaintobjects"),d++}}}}),zingchart.bind(null,"label_click",function(e){var i=zingchart.getLoader(e.id),t=zingchart.getModules(i);if(-1!==ZC.AV(t,"multi-guide")){var a=zingchart.getGraph(i,e.graphid).getData();a.options&&(a.options["multi-guide"]||a.options);var l,r=zingchart.exec(e.id,"getplotlength",{graphid:e.graphid});if(-1!==e.labelid.indexOf("multi_guide_label_")){o=e.labelid.replace("multi_guide_label_","");var g=c["guide_"+o]||"";(l=window.prompt("Marker Name:",g))&&(c["guide_"+o]=l,window.setTimeout(function(){zingchart.exec(e.id,"updateobject",{type:"label",id:"multi_guide_label_"+o,data:{text:l}})},100))}-1!==e.labelid.indexOf("multi_guide_close_")&&(o=e.labelid.replace("multi_guide_close_",""),window.setTimeout(function(){n["guide_"+o]=[],c["guide_"+o]=null,zingchart.exec(e.id,"removeobject",{type:"shape",id:["multi_guide_line_"+o,"multi_guide_handle_"+o]}),zingchart.exec(e.id,"removeobject",{type:"label",id:["multi_guide_label_"+o,"multi_guide_close_"+o]});for(var i=[],t=0;t<r;t++)i.push("multi_guide_label_"+o+"_"+t);zingchart.exec(e.id,"removeobject",{type:"label",id:i});var a=!1;for(var l in c)null!==ZC._n_(c[l])&&(a=!0);a||(d=0,n={},c={})},100))}}),zingchart.bind(null,"shape_mousedown",function(e){e.ev.preventDefault();var i=zingchart.getLoader(e.id),d=zingchart.getModules(i);if(-1!==ZC.AV(d,"multi-guide")&&-1!==e.shapeid.indexOf("multi_guide_handle_")){var n=zingchart.getGraph(i,e.graphid).getData(),c={};n.options&&(c=n.options["multi-guide"]||n.options),l=!0;var r=zingchart.exec(e.id,"getobjectinfo",{graphid:e.graphid,object:"plotarea"}),g=zingchart.exec(e.id,"getplotlength",{graphid:e.graphid});o=ZC._i_(e.shapeid.replace("multi_guide_handle-","")),zingchart.exec(e.id,"setobjectsmode",{mode:"flat"});for(var u=(c.handle||{}).size||4,h=[],_=0;_<g;_++)h.push("multi_guide_label_"+o+"_"+_);zingchart.exec(e.id,"removeobject",{type:"label",id:h,update:!1}),zingchart.exec(e.id,"updateobject",{data:[{objtype:"shape",type:"line",id:"multi_guide_line_"+o,visible:!1,points:[[a,r.y],[a,r.y+r.height]]},{objtype:"shape",type:"poly",id:"multi_guide_handle_"+o,flat:!0,shadow:!0,"shadow-distance":3,points:[[a,r.y],[a-2*u,r.y-u],[a-2*u,r.y-3*u],[a+2*u,r.y-3*u],[a+2*u,r.y-u],[a,r.y]]},{objtype:"label",id:"multi_guide_close_"+o,flat:!0,visible:!1,x:a+2*u,y:r.y-3*u}]});var p=function(i){if(-1===i.target.id.indexOf("multi_guide_close_")){l=!1,zingchart.exec(e.id,"setobjectsmode",{mode:"normal"}),zingchart.exec(e.id,"updateobject",{data:[{objtype:"shape",type:"line",id:"multi_guide_line_"+o,visible:!0,points:[[a,r.y],[a,r.y+r.height]]},{objtype:"shape",type:"poly",id:"multi_guide_handle_"+o,flat:!1,shadow:!1,points:[[a,r.y],[a-2*u,r.y-u],[a-2*u,r.y-3*u],[a+2*u,r.y-3*u],[a+2*u,r.y-u],[a,r.y]]},{objtype:"label",id:"multi_guide_close_"+o,flat:!1,visible:!0,x:a+2*u,y:r.y-3*u},{objtype:"label",id:"multi_guide_label_"+o,flat:!0,x:a}]});for(var d=0;d<t.length;d++){var n=zingchart.exec(e.id,"getobjectinfo",{object:"node",plotindex:t[d].plotindex,nodeindex:t[d].nodeindex});zingchart.exec(e.id,"addobject",{type:"label",data:[{id:"multi_guide_label_"+o+"_"+d,"class":"multi-guide",x:t[d].x,y:t[d].y,flat:!0,color:n.color,text:t[d].text,"background-color":n.lineColor,padding:"3 6",callout:!0,"callout-position":a<r.x+r.width/2?"left":"right"}]})}ZC.A4(document).unbind("mouseup",p)}};ZC.A4(document).bind("mouseup",p)}})}();